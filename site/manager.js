!function(e){function t(t){for(var n,r,l=t[0],s=t[1],c=t[2],d=0,p=[];d<l.length;d++)r=l[d],Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&p.push(i[r][0]),i[r]=0;for(n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n]);for(u&&u(t);p.length;)p.shift()();return o.push.apply(o,c||[]),a()}function a(){for(var e,t=0;t<o.length;t++){for(var a=o[t],n=!0,l=1;l<a.length;l++){var s=a[l];0!==i[s]&&(n=!1)}n&&(o.splice(t--,1),e=r(r.s=a[0]))}return e}var n={},i={1:0},o=[];function r(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=e,r.c=n,r.d=function(e,t,a){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(a,n,function(t){return e[t]}.bind(null,n));return a},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/";var l=window.webpackJsonp=window.webpackJsonp||[],s=l.push.bind(l);l.push=t,l=l.slice();for(var c=0;c<l.length;c++)t(l[c]);var u=s;o.push([353,0]),a()}({15:function(e,t,a){"use strict";var n=a(0),i=a.n(n),o=a(13),r=a.n(o);t.a={getDataList:function(){return i.a.get("/data/getdatalist")},saveDataList:function(e){return i.a.post("/data/savedatalist",e)},getDataFile:function(e){return i.a.get("/data/getdatafile?id=".concat(e))},saveDataFile:function(e,t){var a=new FormData;return a.append("content",t),i.a.post("/data/savedatafile?id=".concat(e),a)},saveDataEntryFromTraffic:function(e,t,a){return i.a.post("/data/savedatafromtraffic",{id:r()(),name:t,contenttype:a,reqid:e})}}},2:function(e,t,a){"use strict";var n=a(0),i=a.n(n);t.a={saveFile:function(e){return i.a.post("/profile/savefile",e)},disableRule:function(){return i.a.post("/profile/setRuleState")},enableRule:function(){return i.a.post("/profile/setRuleState?rulestate=1")},disableHost:function(){return i.a.post("/profile/setHostState")},enableHost:function(){return i.a.post("/profile/setHostState?hoststate=1")},disableFilter:function(){return i.a.post("/profile/setFilterState")},enableFilter:function(){return i.a.post("/profile/setFilterState?filterstate=1")},getUserId:function(){return i.a.get("/profile/getUserId")},getUserInfo:function(){return i.a.get("/profile/getUserInfo")},setUserId:function(e){return i.a.get("/profile/setUserId?userId=".concat(e))},unBind:function(e){return i.a.get("/profile/device/unbind?deviceId=".concat(e))},setDeviceName:function(e,t){return i.a.get("/profile/device/setName?deviceId=".concat(e,"&name=").concat(encodeURI(t)))},disableMonitor:function(e){return i.a.get("/profile/device/disableMonitor?deviceId=".concat(e))},deviceUseHost:function(e,t){return i.a.get("/profile/device/usehost?deviceId=".concat(e,"&hostname=").concat(encodeURI(t)))},enableMonitor:function(e){return i.a.get("/profile/device/enableMonitor?deviceId=".concat(e))},setExternalProxy:function(e,t){return t.deviceId=e,i.a.post("/profile/device/externalProxy",t)}}},205:function(e,t,a){},206:function(e,t,a){},21:function(e,t,a){"use strict";var n=a(0),i=a.n(n),o={getRemoteFile:function(e){return i.a.get("/utils/getRemoteFile?url=".concat(encodeURIComponent(e)))},getGatewayMachine:function(){return i.a.get("/utils/gateway/get-machine")},getConfigInfo:function(e){return i.a.get("/utils/gateway/config?deviceId=".concat(e))},setGateWay:function(e,t){return i.a.post("/utils/gateway/set?deviceId=".concat(e),t)}};t.a=o},252:function(e,t,a){"use strict";var n=a(54);a.n(n).a},253:function(e,t,a){},254:function(e,t,a){"use strict";var n=a(55);a.n(n).a},255:function(e,t,a){"use strict";var n=a(56);a.n(n).a},328:function(e,t,a){},329:function(e,t,a){"use strict";var n=a(57);a.n(n).a},330:function(e,t,a){"use strict";var n=a(58);a.n(n).a},331:function(e,t,a){},332:function(e,t,a){"use strict";var n=a(59);a.n(n).a},333:function(e,t,a){},334:function(e,t,a){"use strict";var n=a(60);a.n(n).a},336:function(e,t,a){},337:function(e,t,a){"use strict";var n=a(61);a.n(n).a},338:function(e,t,a){"use strict";var n=a(62);a.n(n).a},339:function(e,t,a){},340:function(e,t,a){},353:function(e,t,a){"use strict";a.r(t);a(68);var n=a(64),i=a.n(n),o=(a(119),a(3)),r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"main-wrapper"},[a("el-container",[a("el-aside",{attrs:{width:"200px"}},[a("left-menu")],1),e._v(" "),a("el-container",[a("el-header",{attrs:{height:"72px"}},[a("manager-header")],1),e._v(" "),a("el-main",[a("router-view")],1)],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"新建Mock数据文件",visible:e.addDataFileForm.visible},on:{"update:visible":function(t){return e.$set(e.addDataFileForm,"visible",t)}}},[a("el-form",{attrs:{model:e.addDataFileForm,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"名称"}},[a("el-input",{model:{value:e.addDataFileForm.name,callback:function(t){e.$set(e.addDataFileForm,"name",t)},expression:"addDataFileForm.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"格式"}},[a("el-select",{attrs:{placeholder:"请选择数据文件格式"},model:{value:e.addDataFileForm.contenttype,callback:function(t){e.$set(e.addDataFileForm,"contenttype",t)},expression:"addDataFileForm.contenttype"}},[a("el-option",{attrs:{label:"html",value:"text/html"}}),e._v(" "),a("el-option",{attrs:{label:"json",value:"application/json"}}),e._v(" "),a("el-option",{attrs:{label:"javascript",value:"application/javascript"}})],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.addDataFileForm.visible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.addDataFile}},[e._v("确 定")])],1)],1),e._v(" "),a("el-dialog",{ref:"editDataFileDialog",attrs:{title:"编辑Mock数据文件","close-on-press-escape":!1,visible:e.editDataFileForm.visible},on:{"update:visible":function(t){return e.$set(e.editDataFileForm,"visible",t)}}},[a("span",{attrs:{slot:"title"},slot:"title"},[e._v("\n            编辑数据文件 "+e._s(e.editDataFileForm.entry.name)+" [Content-Type: "+e._s(e.editDataFileForm.entry.contenttype)+"]\n        ")]),e._v(" "),a("div",{staticStyle:{height:"305px"},attrs:{id:"content-editor-container"}},[a("div",{attrs:{id:"content-editor"}})]),e._v(" "),a("div",[e._v("\n            Press "),a("strong",[e._v("F11")]),e._v(" when cursor is in the editor to\n            toggle full screen editing. "),a("strong",[e._v("Esc")]),e._v(" can also be used\n            to "),a("i",[e._v("exit")]),e._v(" full screen editing.\n        ")]),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.editDataFileForm.visible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{on:{click:e.toggleFullScreen}},[e._v("全屏")]),e._v(" "),a("el-button",{on:{click:e.formatEditor}},[e._v("格式化")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.finishEditDataFile}},[e._v("确 定")])],1)])],1)};r._withStripped=!0;var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"left-menu"},[a("h2",[e._v("Http Trick")]),e._v(" "),a("el-menu",{staticClass:"el-menu-vertical-demo",attrs:{"default-active":e.defaultActive},on:{select:e.handleSelect}},[e._l(e.menuList,(function(t,n){return[a("div",{key:n},[a("el-menu-item",{attrs:{index:n+""}},[a("i",{staticClass:"iconfont",class:t.icon}),e._v(" "),a("span",{staticClass:"menu-name"},[e._v("\n                      "+e._s(t.name)+"\n                    ")])])],1)]}))],2)],1)};l._withStripped=!0;a(205);var s={name:"left-menu",data:function(){return{}},computed:{menuList:function(){var e=[{name:"使用说明",icon:"icon-search",link:"helpinstall"}];return"root"==this.$dc.userId&&(e=e.concat([{name:"基础配置",icon:"icon-set",link:"configure"},{name:"转发路径变量",icon:"icon-layers",link:"redirect-path-variable"}])),e=this.$dc.configure.professionalVersion?e.concat([{name:"Host 管理",icon:"icon-box",link:"hostfilelist"},{name:"Http 过滤器",icon:"icon-beaker",link:"filter"},{name:"Http 转发",icon:"icon-skip",link:"rulefilelist"},{name:"自定义 mock 数据",icon:"icon-suoding",link:"datalist"},{name:"设备管理",icon:"icon-bargraph",link:"device"},{name:"代理设置",icon:"icon-set",link:"proxyconfig"}]):e.concat([{name:"Http 转发",icon:"icon-skip",link:"rulefilelist"},{name:"自定义 mock 数据",icon:"icon-suoding",link:"datalist"},{name:"代理设置",icon:"icon-set",link:"proxyconfig"}])},defaultActive:function(){var e=location.hash,t="0";return this.menuList.forEach((function(a,n){-1!==e.indexOf(a.link)&&(t=n+"")})),t}},methods:{handleSelect:function(e,t){var a={};if(2==t.length){var n=t[1].split("-");a=this.menuList[n[0]].children[n[1]]}else a=this.menuList[parseInt(e)];a.targetBlank?window.open(a.link):this.$router.push(a.link)}}},c=a(1),u=Object(c.a)(s,l,[],!1,null,null,null);u.options.__file="src/manager/components/common/LeftMenu.vue";var d=u.exports,p=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"head-nav"},[a("div",{staticClass:"menu-slot"},[a("el-dropdown",{attrs:{"hide-on-click":!1,placement:"bottom-start"},on:{command:e.$dc.selectHostFile}},[a("el-button",{attrs:{type:"primary",size:"small",disabled:!e.$dc.profile.enableHost}},[e._v("\n                Host 切换"),a("i",{staticClass:"el-icon-caret-bottom el-icon--right"})]),e._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},e._l(e.$dc.hostFileList,(function(t){return a("el-dropdown-item",{attrs:{command:t.name}},[e._v("\n                    "+e._s(t.name)+"\n                    "),t.checked?a("i",{staticClass:"el-icon-check"}):e._e()])})),1)],1),e._v(" "),a("span",[a("el-switch",{attrs:{value:e.$dc.profile.enableHost,"active-text":"","inactive-text":""},on:{input:e.$dc.switchHost}})],1)],1),e._v(" "),a("div",{staticClass:"menu-slot"},[a("el-dropdown",{attrs:{"hide-on-click":!1},on:{command:e.$dc.selectRuleFile}},[a("el-button",{attrs:{type:"primary",size:"small",disabled:!e.$dc.profile.enableRule}},[e._v("\n                Rule 设置"),a("i",{staticClass:"el-icon-caret-bottom el-icon--right"})]),e._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},e._l(e.$dc.ruleFileList,(function(t){return a("el-dropdown-item",{attrs:{command:t.name+"-%-"+t.checked}},[e._v("\n                    "+e._s(t.name)+"\n                    "),t.checked?a("i",{staticClass:"el-icon-check"}):e._e()])})),1)],1),e._v(" "),a("span",[a("el-switch",{attrs:{value:e.$dc.profile.enableRule,"active-text":"","inactive-text":""},on:{input:e.$dc.switchRule}})],1)],1),e._v(" "),a("div",{staticClass:"menu-slot"},[e._v("\n        过滤器开关\n        "),a("el-switch",{attrs:{value:e.$dc.profile.enableFilter,"active-text":"","inactive-text":""},on:{input:e.$dc.switchFilter}})],1),e._v(" "),a("div",{staticClass:"menu-slot link-blank"},[a("a",{attrs:{href:"/monitor.html",target:"_blank"}},[a("el-button",{attrs:{type:"text"}},[e._v("监控窗")])],1),e._v(" "),a("a",{attrs:{href:"/help/index.html",target:"_blank"}},[a("el-button",{attrs:{type:"text"}},[e._v("帮助中心")])],1),e._v(" "),e.$dc.appInfo.single?e._e():a("a",{attrs:{href:"javascript:void(0)"},on:{click:e.changeUser}},[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"点击切换用户",placement:"top"}},[a("el-button",{attrs:{type:"text"}},[e._v(e._s(e.$dc.userId))])],1)],1)])])};p._withStripped=!0;a(206);var m=a(2);function f(e,t,a,n,i,o,r){try{var l=e[o](r),s=l.value}catch(e){return void a(e)}l.done?t(s):Promise.resolve(s).then(n,i)}var v={name:"ManagerHeader",methods:{changeUser:function(){var e=this;this.$prompt("请输入用户名(不输入内容将会使用本机ip作为用户名)","切换用户",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(){var t,a=(t=regeneratorRuntime.mark((function t(a){var n,i,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=a.value,t.next=3,m.a.setUserId(n||"");case 3:i=t.sent,o=i.data.data.userId,e.$dc.userId=o,location.reload();case 7:case"end":return t.stop()}}),t)})),function(){var e=this,a=arguments;return new Promise((function(n,i){var o=t.apply(e,a);function r(e){f(o,n,i,r,l,"next",e)}function l(e){f(o,n,i,r,l,"throw",e)}r(void 0)}))});return function(e){return a.apply(this,arguments)}}()).catch((function(){}))}}},h=Object(c.a)(v,p,[],!1,null,null,null);h.options.__file="src/manager/components/common/Header.vue";var g=h.exports,b=a(0),_=a.n(b),y=a(4),x=a.n(y),k={createFile:function(e,t){return _.a.post("/host/create",{name:e,description:t})},getFileList:function(){return _.a.get("/host/filelist")},deleteFile:function(e){return _.a.get("/host/deletefile?name=".concat(e))},useFile:function(e){return _.a.get("/host/usefile?name=".concat(e))},getFileContent:function(e){return _.a.get("/host/getfile?name=".concat(e))},saveFile:function(e,t){return _.a.post("/host/savefile?name=".concat(e),t)}};k.debouncedUseFile=x.a.debounce((function(e,t){k.useFile(e).then((function(e){t(e)}))}),500);var F=k,w={createFile:function(e,t){return _.a.post("/rule/create",{name:e,description:t})},getFileList:function(){return _.a.get("/rule/filelist")},deleteFile:function(e){return _.a.get("/rule/deletefile?name=".concat(e))},setFileCheckStatus:function(e,t){return _.a.get("/rule/setfilecheckstatus?name=".concat(e,"&checked=").concat(t?1:0))},getFileContent:function(e){return _.a.get("/rule/getfile?name=".concat(e))},saveFile:function(e,t){return _.a.post("/rule/savefile?name=".concat(e),t)},testRule:function(e){return _.a.post("/rule/test",e)},getRemoteRuleFile:function(e){return _.a.get("/utils/getGitlabFile?url=".concat(encodeURIComponent(e)))},getReferenceVar:function(e){for(var t,a=JSON.stringify(e),n=RegExp("<%=(.+?)%>","g"),i={};null!=(t=n.exec(a));)i[x.a.trim(t[1])]=1;return x.a.keys(i)}};w.debouncedSaveFile=x.a.debounce((function(e,t,a){w.saveFile(e,t).then((function(e){a(e)}))}),3e3);var $=w,R=function(e){return _.a.post("/configure/savefile",e)},S=a(10),C=a.n(S),P=a(15),D=a(13),I=a.n(D),E=a(20),H=a.n(E);a(226),a(227),a(228),a(125),a(229);function q(e,t,a,n,i,o,r){try{var l=e[o](r),s=l.value}catch(e){return void a(e)}l.done?t(s):Promise.resolve(s).then(n,i)}function O(e){return function(){var t=this,a=arguments;return new Promise((function(n,i){var o=e.apply(t,a);function r(e){q(o,n,i,r,l,"next",e)}function l(e){q(o,n,i,r,l,"throw",e)}r(void 0)}))}}var T=null;o.default.component(d.name,d),o.default.component(g.name,g);var L,j,M,N,U,z={name:"app",data:function(){return{isDataCenter:!0,userId:"guest",appInfo:{},configure:{},profile:{projectPath:[],enableRule:!1},redirectPathVariableArray:[],bindedDeviceList:[],rule:[],hostFileList:[],ruleFileList:[],filters:[],dataList:[],addDataFileForm:{visible:!1,callback:null,id:"",name:"",contenttype:""},editDataFileForm:{visible:!1,entry:{},content:""}}},computed:{ruleState:function(){return this.profile.enableRule||!1},hostState:function(){return this.profile.enableHost||!1},filterState:function(){return this.profile.enableFilter||!1}},methods:{switchHost:(U=O(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.profile.enableHost){e.next=5;break}return e.next=3,m.a.disableHost();case 3:e.next=7;break;case 5:return e.next=7,m.a.enableHost();case 7:case"end":return e.stop()}}),e,this)}))),function(e){return U.apply(this,arguments)}),selectHostFile:(N=O(regeneratorRuntime.mark((function e(t){var a,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=t,F.debouncedUseFile(a,(function(e){var t=e.data;0==t.code?n.$message({showClose:!0,type:"success",message:"设置成功!"}):n.$message.error("出错了,请刷新页面，".concat(t.msg))}));case 2:case"end":return e.stop()}}),e)}))),function(e){return N.apply(this,arguments)}),switchFilter:(M=O(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.profile.enableFilter?m.a.disableFilter():m.a.enableFilter();case 1:case"end":return e.stop()}}),e,this)}))),function(e){return M.apply(this,arguments)}),switchRule:(j=O(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.profile.enableRule?m.a.disableRule():m.a.enableRule();case 1:case"end":return e.stop()}}),e,this)}))),function(e){return j.apply(this,arguments)}),selectRuleFile:function(e){var t=this,a=e.split("-%-");$.setFileCheckStatus(a[0],"false"==a[1]).then((function(e){var a=e.data;0!=a.code&&t.$message.error("出错了，".concat(a.msg))}))},deleteDataFile:function(e,t){var a=this;this.$confirm("此操作将永久删除该数据文件: ".concat(e.name,", 是否继续?"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){a.dataList.splice(t,1),P.a.saveDataList(a.dataList).then((function(e){var t=e.data;0==t.code?a.$message({showClose:!0,type:"success",message:"删除成功!"}):a.$message.error("出错了，".concat(t.msg))}))}))},requestAddDataFile:function(e){this.addDataFileForm.callback=e,this.addDataFileForm.visible=!0},addDataFile:function(){var e=this;this.addDataFileForm.visible=!1;var t=I()();this.dataList.push({id:t,name:this.addDataFileForm.name,contenttype:this.addDataFileForm.contenttype}),P.a.saveDataList(this.dataList).then((function(a){var n=a.data;0==n.code?(e.$message({showClose:!0,type:"success",message:"新建成功!"}),e.addDataFileForm.name="",e.addDataFileForm.contenttype="",e.addDataFileForm.callback&&e.addDataFileForm.callback(t),e.addDataFileForm.callback=null):e.$message.error("出错了，".concat(n.msg))}))},toggleFullScreen:function(){T.getOption("fullScreen")?C()("#content-editor").parents(".el-dialog").css("transform",""):C()("#content-editor").parents(".el-dialog").css("transform","initial"),T.setOption("fullScreen",!T.getOption("fullScreen")),T.focus()},closeFullScreen:function(){T.getOption("fullScreen")&&(T.setOption("fullScreen",!1),C()("#content-editor").parents(".el-dialog").css("transform",""),T.focus())},formatEditor:function(){try{if(!/json/i.test(this.editDataFileForm.entry.contenttype))return;var e=T.getValue(),t=JSON.stringify(JSON.parse(e),null,4);T.setValue(t),T.refresh(),T.focus()}catch(e){}},requestEditDataFile:function(e){var t=this;this.editDataFileForm.entry=e,P.a.getDataFile(e.id).then((function(a){var n=a.data;0==n.code?(t.editDataFileForm.visible=!0,T?(T.setValue(n.data),T.setOption("mode",e.contenttype),t.$nextTick((function(){T.refresh(),T.focus()}))):t.$nextTick((function(){window.$=C.a,window.editor=T=new H.a(document.getElementById("content-editor"),{value:n.data,mode:e.contenttype,lineNumbers:!0,matchBrackets:!0,autofocus:!0,extraKeys:{F11:function(e){t.toggleFullScreen()},Esc:function(e){t.closeFullScreen()}}})}))):t.$message.error("出错了，".concat(n.msg))}))},finishEditDataFile:function(){var e=this,t=this.editDataFileForm.entry;P.a.saveDataFile(t.id,T.getValue()).then((function(t){var a=t.data;0==a.code?(e.$message({showClose:!0,type:"success",message:"保存成功!"}),e.editDataFileForm.entry={},e.editDataFileForm.visible=!1,T.setValue("")):e.$message.error("出错了，".concat(a.msg))}))}},created:(L=O(regeneratorRuntime.mark((function e(){var t,a,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a.getUserId();case 2:if(t=e.sent,this.userId=t.data.data.userId,window.io){e.next=6;break}return e.abrupt("return");case 6:(a=io("/manager")).on("configure",(function(e){n.configure=e})),a.on("appinfo",(function(e){n.appInfo=e})),a.on("profile",(function(e){n.profile=e;var t=[];x.a.forEach(e.redirectPathVariables,(function(e,a){t.push({key:a,value:e})})),n.redirectPathVariableArray=t})),a.on("bindedDeviceList",(function(e){n.bindedDeviceList=e})),a.on("hostfilelist",(function(e){n.hostFileList=e})),a.on("rulefilelist",(function(e){n.ruleFileList=e})),a.on("filters",(function(e){n.filters=e})),a.on("datalist",(function(e){n.dataList=e}));case 15:case"end":return e.stop()}}),e,this)}))),function(){return L.apply(this,arguments)}),mounted:function(){this.$refs.editDataFileDialog.rendered=!0}},V=Object(c.a)(z,r,[],!1,null,null,null);V.options.__file="src/manager/App.vue";var A=V.exports,B=a(99),J=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"view-configure"},[a("div",{staticClass:"main-content__title"},[e._v("基础配置修改")]),e._v(" "),a("el-form",{attrs:{"label-width":"200px"}},[a("el-form-item",{attrs:{label:"是否开启Http代理"}},[a("el-checkbox",{model:{value:e.$dc.configure.startHttpProxy,callback:function(t){e.$set(e.$dc.configure,"startHttpProxy",t)},expression:"$dc.configure.startHttpProxy"}},[e._v("开启")])],1),e._v(" "),a("el-form-item",{attrs:{label:"是否开启Socks5代理"}},[a("el-checkbox",{model:{value:e.$dc.configure.startSocks5,callback:function(t){e.$set(e.$dc.configure,"startSocks5",t)},expression:"$dc.configure.startSocks5"}},[e._v("开启")])],1),e._v(" "),a("el-form-item",{attrs:{label:"是否开启DNS服务"}},[a("el-checkbox",{model:{value:e.$dc.configure.startDns,callback:function(t){e.$set(e.$dc.configure,"startDns",t)},expression:"$dc.configure.startDns"}},[e._v("开启")])],1),e._v(" "),a("el-form-item",{attrs:{label:"是否开启专业版"}},[a("el-checkbox",{model:{value:e.$dc.configure.professionalVersion,callback:function(t){e.$set(e.$dc.configure,"professionalVersion",t)},expression:"$dc.configure.professionalVersion"}},[e._v("开启")])],1),e._v(" "),a("el-form-item",{attrs:{label:"Http代理端口"}},[a("el-input",{attrs:{placeholder:"http代理端口"},model:{value:e.$dc.configure.httpProxyPort,callback:function(t){e.$set(e.$dc.configure,"httpProxyPort",t)},expression:"$dc.configure.httpProxyPort"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"Socks5端口"}},[a("el-input",{attrs:{placeholder:"socks5代理端口"},model:{value:e.$dc.configure.socks5ProxyPort,callback:function(t){e.$set(e.$dc.configure,"socks5ProxyPort",t)},expression:"$dc.configure.socks5ProxyPort"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"WebUi端口"}},[a("el-input",{attrs:{placeholder:"WebUi端口"},model:{value:e.$dc.configure.webUiPort,callback:function(t){e.$set(e.$dc.configure,"webUiPort",t)},expression:"$dc.configure.webUiPort"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"DNS端口"}},[a("el-input",{attrs:{placeholder:"DNS端口"},model:{value:e.$dc.configure.dnsPort,callback:function(t){e.$set(e.$dc.configure,"dnsPort",t)},expression:"$dc.configure.dnsPort"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"超时时间"}},[a("el-input",{attrs:{placeholder:"远程服务器响应超时，proxy会终止请求"},model:{value:e.$dc.configure.requestTimeoutTime,callback:function(t){e.$set(e.$dc.configure,"requestTimeoutTime",t)},expression:"$dc.configure.requestTimeoutTime"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.saveFile}},[e._v("保存")])],1)],1)],1)};J._withStripped=!0;var K=a(34),Q=a.n(K);function G(e,t,a,n,i,o,r){try{var l=e[o](r),s=l.value}catch(e){return void a(e)}l.done?t(s):Promise.resolve(s).then(n,i)}var W,X,Y={name:"configure",computed:{socksProxyExample:function(){return"#示例\n0.0.0.0    # 任何80 443端口的请求经过socks5时都会被解析\n4.4.4.4    # 没有0.0.0.0的情况下，socks5代理中只有4.4.4.4的80、443端口的请求被解析"}},methods:{saveFile:(W=regeneratorRuntime.mark((function e(){var t,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.$dc.configure.requestTimeoutTime=parseInt(this.$dc.configure.requestTimeoutTime),this.$dc.configure.proxyPort=parseInt(this.$dc.configure.proxyPort),this.$dc.configure.socks5Port=parseInt(this.$dc.configure.socks5Port),e.next=5,R(this.$dc.configure);case 5:t=e.sent,0==(a=t.data).code?this.$message({showClose:!0,type:"success",message:"保存成功!"}):this.$message.error("出错了，".concat(a.msg));case 8:case"end":return e.stop()}}),e,this)})),X=function(){var e=this,t=arguments;return new Promise((function(a,n){var i=W.apply(e,t);function o(e){G(i,a,n,o,r,"next",e)}function r(e){G(i,a,n,o,r,"throw",e)}o(void 0)}))},function(){return X.apply(this,arguments)})}},Z=(a(252),Object(c.a)(Y,J,[],!1,null,null,null));Z.options.__file="src/manager/components/configure/Configure.vue";var ee=Z.exports,te=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"project-wraper"},[a("div",{staticClass:"main-content__title"},[e._v("转发路径变量管理")]),e._v(" "),a("div",{staticClass:"project-path-info"},[e._v("配置http转发规则时，转发路径可以引用这里的变量。例如：将http请求转发到${ helloworld }/dist/hello.js，${\n        helloworld }会被替换为变量helloworld对应的值。\n    ")]),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.$dc.redirectPathVariableArray}},[a("el-table-column",{attrs:{prop:"key",label:"变量名",width:"250"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{placeholder:"工程名"},model:{value:t.row.key,callback:function(a){e.$set(t.row,"key",a)},expression:"scope.row.key"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"value",label:"变量值"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{placeholder:"工程在本地的绝对路径"},model:{value:t.row.value,callback:function(a){e.$set(t.row,"value",a)},expression:"scope.row.value"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{width:"60",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticClass:"delete-btn",attrs:{type:"danger",icon:"el-icon-delete",size:"mini"},on:{click:function(a){return e.deleteParam(t.row,t.$index)}}})]}}])})],1),e._v(" "),a("div",{staticStyle:{"margin-top":"50px","text-align":"right"}},[a("el-button",{on:{click:e.addParam}},[e._v("增加工程路径设置")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.saveFile}},[e._v("保存")])],1)],1)};te._withStripped=!0;a(253);function ae(e,t,a,n,i,o,r){try{var l=e[o](r),s=l.value}catch(e){return void a(e)}l.done?t(s):Promise.resolve(s).then(n,i)}var ne={name:"project-path",methods:{deleteParam:function(e,t,a){var n=this;this.$confirm("此操作不可恢复, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){n.$dc.redirectPathVariableArray.splice(t,1)}))},saveFile:function(){var e=function(e){return function(){var t=this,a=arguments;return new Promise((function(n,i){var o=e.apply(t,a);function r(e){ae(o,n,i,r,l,"next",e)}function l(e){ae(o,n,i,r,l,"throw",e)}r(void 0)}))}}(regeneratorRuntime.mark((function e(){var t,a,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={},Q()(this.$dc.redirectPathVariableArray,(function(e){t[e.key]=e.value})),this.$dc.profile.redirectPathVariables=t,e.next=5,m.a.saveFile(this.$dc.profile);case 5:a=e.sent,0==(n=a.data).code?this.$message({showClose:!0,type:"success",message:"保存成功!"}):this.$message.error("出错了，".concat(n.msg));case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),addParam:function(){this.$dc.redirectPathVariableArray.push({key:"",value:""})}}},ie=Object(c.a)(ne,te,[],!1,null,null,null);ie.options.__file="src/manager/components/configure/RedirectPathVariable.vue";var oe=ie.exports,re=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"host-view"},[a("div",{staticClass:"main-content__title"},[e._v("Host 文件列表")]),e._v(" "),a("div",{staticClass:"project-path-info"},[e._v("只允许一个host文件生效。")]),e._v(" "),a("el-row",{staticStyle:{"margin-bottom":"10px"},attrs:{gutter:20}},[a("el-col",{staticClass:"addhost-btn-wrap",attrs:{span:6,offset:18}},[a("el-button",{attrs:{size:"small"},on:{click:e.addNewHostFile}},[e._v("新增 Host 文件")])],1)],1),e._v(" "),a("el-table",{attrs:{border:"",align:"center",data:e.$dc.hostFileList}},[a("el-table-column",{attrs:{prop:"name",label:"名字",width:"150"}}),e._v(" "),a("el-table-column",{attrs:{prop:"description",label:"描述"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:136,context:e._self},scopedSlots:e._u([{key:"default",fn:function(t){return[a("a",{attrs:{href:"#/edithost?name="+t.row.name}},[a("el-button",{attrs:{type:"info",icon:"el-icon-edit",size:"mini"}})],1),e._v(" "),a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini"},on:{click:function(a){return e.onDeleteFile(t.row,t.$index,e.user_list)}}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"checked",label:"启用",width:"85"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-radio",{attrs:{label:t.row.name,disabled:!e.$dc.hostState},model:{value:e.selectedFileName,callback:function(t){e.selectedFileName=t},expression:"selectedFileName"}})]}}])})],1)],1)};re._withStripped=!0;var le={name:"hostlist",computed:{selectedFileName:{get:function(){var e=x.a.find(this.$dc.hostFileList,(function(e){return e.checked}));return e?e.name:""},set:function(e){this.$dc.hostFileList.forEach((function(t){t.name!=e?t.checked=!1:t.checked=!0})),this.useFile(e)}}},methods:{onDeleteFile:function(e,t,a){var n=this;this.$confirm("此操作将永久删除该文件: ".concat(e.name,", 是否继续?"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){F.deleteFile(e.name).then((function(e){var t=e.data;0==t.code?n.$message({showClose:!0,type:"success",message:"删除成功!"}):n.$message.error("出错了，".concat(t.msg))}))}))},useFile:function(e){var t=this;F.debouncedUseFile(e,(function(e){var a=e.data;0==a.code?t.$message({showClose:!0,type:"success",message:"设置成功!"}):t.$message.error("出错了,请刷新页面，".concat(a.msg))}))},addNewHostFile:function(){this.$router.push("createhostfile")}}},se=(a(254),Object(c.a)(le,re,[],!1,null,null,null));se.options.__file="src/manager/components/host/FileList.vue";var ce=se.exports,ue=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"main-content__title"},[e._v("编辑Host文件"+e._s(e.loaded?": "+e.filecontent.name:""))]),e._v(" "),a("el-row",{staticStyle:{"margin-bottom":"10px"},attrs:{gutter:20}},[a("el-col",{attrs:{span:6,offset:18}},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.saveFile}},[e._v("保存文件")])],1)],1),e._v(" "),a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.filecontent.content,expression:"filecontent.content"}],staticClass:"host-editor",attrs:{placeholder:e.hostExample},domProps:{value:e.filecontent.content},on:{input:function(t){t.target.composing||e.$set(e.filecontent,"content",t.target.value)}}})],1)};ue._withStripped=!0;var de={name:"app",data:function(){return{loaded:!1,filecontent:{content:""}}},computed:{hostExample:function(){return"#示例\n8.8.8.8    www.google.com\n4.4.4.4    *.taobao.com #所有后缀为.taobao.com的域名都被解析为4.4.4.4\n6.6.6.6    www.youzan.com h5.youzan.com"}},methods:{getFile:function(){var e=this;this.loaded=!1,F.getFileContent(this.$route.query.name).then((function(t){var a=t.data;0==a.code?(e.loaded=!0,e.filecontent=a.data,e.hostarray=[],Q()(e.filecontent.content,(function(t,a){e.hostarray.push({key:a,value:t})}))):e.$message.error("出错了，".concat(a.msg))}))},saveFile:function(){var e=this;F.saveFile(this.$route.query.name,this.filecontent).then((function(t){var a=t.data;0==a.code?e.$message({showClose:!0,type:"success",message:"保存成功!"}):e.$message.error("出错了，".concat(a.msg))}))}},mounted:function(){this.getFile()},watch:{$route:function(e,t){this.getFile()}}},pe=(a(255),Object(c.a)(de,ue,[],!1,null,null,null));pe.options.__file="src/manager/components/host/EditHost.vue";var me=pe.exports,fe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"main-content__title"},[e._v("创建Host文件")]),e._v(" "),a("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",staticStyle:{margin:"20px",width:"60%","min-width":"600px"},attrs:{model:e.createFileForm,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"文件名字",prop:"name"}},[a("el-input",{model:{value:e.createFileForm.name,callback:function(t){e.$set(e.createFileForm,"name",t)},expression:"createFileForm.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"文件描述",prop:"description"}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.createFileForm.description,callback:function(t){e.$set(e.createFileForm,"description",t)},expression:"createFileForm.description"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("立即创建")]),e._v(" "),a("el-button",{on:{click:e.back}},[e._v("返回")])],1)],1)],1)};fe._withStripped=!0;var ve={name:"app",data:function(){return{createFileForm:{name:"",description:""},rules:{name:[{required:!0,message:"请输入文件名称名称",trigger:"blur"},{min:2,max:50,message:"长度在 2 到 50 个字符",trigger:"blur"}],description:[{required:!0,message:"请填文件描述",trigger:"blur"}]}}},methods:{submitForm:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return console.log("error submit!!"),!1;F.createFile(t.createFileForm.name,t.createFileForm.description).then((function(e){var a=e.data;0==a.code?(t.$message({showClose:!0,message:"恭喜你，创建成功",type:"success"}),t.$router.push("edithost?name=".concat(t.createFileForm.name))):t.$message.error("出错了，".concat(a.msg))}))}))},back:function(){this.$router.push("hostfilelist")}}},he=Object(c.a)(ve,fe,[],!1,null,null,null);he.options.__file="src/manager/components/host/CreateFile.vue";var ge=he.exports,be=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"main-content__title"},[e._v("规则集列表")]),e._v(" "),a("div",{staticClass:"project-path-info"},[e._v("http转发规则以规则集的方式组织，可以控制单个规则集是否启用。")]),e._v(" "),a("div",{staticClass:"rule-list-op"},[a("div",{staticClass:"op"},[a("input",{staticClass:"importfile",attrs:{type:"file"},on:{change:e.fileUpload}}),e._v(" "),a("el-button",{attrs:{size:"small"}},[e._v("导入规则集")])],1),e._v(" "),a("div",{staticClass:"op"},[a("el-button",{attrs:{size:"small"},on:{click:e.importRemoteRule}},[e._v("导入远程规则")])],1),e._v(" "),a("div",{staticClass:"op"},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.addRuleCollection}},[e._v("新增规则集")])],1)]),e._v(" "),a("el-table",{attrs:{border:"",data:e.$dc.ruleFileList}},[a("el-table-column",{attrs:{prop:"name",label:"名字",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s(t.row.name)+"\n                "),t.row.meta.remote?a("el-tag",{attrs:{type:"danger","close-transition":""}},[e._v("远程")]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"description",label:"描述"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:230},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"rule-file-op-container"},[a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini"},on:{click:function(a){return e.onDeleteFile(t.row,t.$index)}}}),e._v(" "),a("a",{attrs:{href:"#/editrule?name="+t.row.name}},[a("el-button",{attrs:{type:"info",icon:"el-icon-edit",size:"mini"}})],1),e._v(" "),a("el-button",{attrs:{type:"info",icon:"el-icon-download",size:"mini"},on:{click:function(a){return e.onDownloadFile(t.row,t.$index)}}}),e._v(" "),a("span",[a("el-button",{attrs:{type:"info",icon:"el-icon-share",size:"mini"},on:{click:function(a){return e.onShareFile(t.row,t.$index)}}})],1)],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"启用",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-switch",{attrs:{disabled:!e.$dc.ruleState},on:{change:function(a){return e.onSelectionChange(t.row.name,t.row.checked)}},model:{value:t.row.checked,callback:function(a){e.$set(t.row,"checked",a)},expression:"scope.row.checked"}})]}}])})],1)],1)};be._withStripped=!0;var _e=a(14),ye=a.n(_e),xe=a(21),ke=a(65),Fe=a.n(ke);a(328);function we(e,t,a,n,i,o,r){try{var l=e[o](r),s=l.value}catch(e){return void a(e)}l.done?t(s):Promise.resolve(s).then(n,i)}var $e,Re={name:"rulefilelist",methods:{onDeleteFile:function(e,t){var a=this;this.$confirm("此操作将永久删除该文件: ".concat(e.name,", 是否继续?"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){$.deleteFile(e.name).then((function(e){var t=e.data;0==t.code?a.$message({showClose:!0,type:"success",message:"删除成功!"}):a.$message.error("出错了，".concat(t.msg))}))}))},onDownloadFile:function(e,t){e.meta.remote?this.$alert(e.meta.url,"规则URL",{confirmButtonText:"OK",callback:function(e){}}):window.location="/rule/download?name="+e.name},onShareFile:function(e,t){var a="http://".concat(this.$dc.appInfo.pcIp,":").concat(this.$dc.appInfo.webUiPort,"/rule/file/raw?name=").concat(encodeURIComponent(e.name));ye()(a),this.$message("已复制规则".concat(encodeURIComponent(e.name),"链接"))},importRemoteRule:($e=function(e){return function(){var t=this,a=arguments;return new Promise((function(n,i){var o=e.apply(t,a);function r(e){we(o,n,i,r,l,"next",e)}function l(e){we(o,n,i,r,l,"throw",e)}r(void 0)}))}}(regeneratorRuntime.mark((function e(){var t,a,n,i,o,r,l,s=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$prompt("请输入远程规则文件的url","导入远程规则",{confirmButtonText:"确定",cancelButtonText:"取消"});case 2:return t=e.sent,a=t.value,console.log(a),e.next=7,xe.a.getRemoteFile(a);case 7:n=e.sent,i=n.data,(o=i.data).meta={remote:!0,url:a},o.name=o.name+"-remote",o.checked=!1,r=$.getReferenceVar(o),l=r.length>0?"导入规则文件名为".concat(o.name,",引用变量【").concat(r.join("; "),"】请确保变量已经在转发路径变量中设置过"):"导入规则文件名为".concat(o.name),this.$alert(l,"导入远程规则",{confirmButtonText:"确定",callback:function(e){"confirm"==e&&$.saveFile(o.name,o).then((function(e){var t=e.data;0==t.code?s.$message({showClose:!0,message:"恭喜你，导入成功",type:"success"}):s.$message.error("出错了，".concat(t.msg))}))}});case 16:case"end":return e.stop()}}),e,this)}))),function(){return $e.apply(this,arguments)}),onSelectionChange:function(e,t){var a=this;$.setFileCheckStatus(e,t).then((function(e){var t=e.data;0==t.code?a.$message({showClose:!0,type:"success",message:"设置成功!"}):a.$message.error("出错了，".concat(t.msg))}))},addRuleCollection:function(){this.$router.push("createrulefile")},fileUpload:function(e){var t=this,a=e.target.files[0];if(a&&!(a.type.indexOf("json")<0)){var n=new FileReader;n.onload=function(e){var a=e.target.result,n=JSON.parse(a);if(n.checked=!1,Fe()(t.fileList,(function(e){return e.name==n.name})))t.$message.error("已经存在名为".concat(n.name,"的规则，请修改规则文件里的name字段,以及文件名"));else{var i,o=$.getReferenceVar(n);i=o.length>0?"导入规则文件名为".concat(n.name,",引用变量【").concat(o.join("; "),"】请确保变量已经在转发路径变量里设置过值"):"导入规则文件名为".concat(n.name),t.$alert(i,"规则文件导入",{confirmButtonText:"确定",callback:function(e){"confirm"==e&&$.saveFile(n.name,n).then((function(e){var a=e.data;0==a.code?t.$message({showClose:!0,message:"恭喜你，导入成功",type:"success"}):t.$message.error("出错了，".concat(a.msg))}))}})}},n.readAsText(a)}}}},Se=(a(329),Object(c.a)(Re,be,[],!1,null,null,null));Se.options.__file="src/manager/components/rule/FileList.vue";var Ce=Se.exports,Pe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"main-content__title"},[e._v("编辑规则集"+e._s(e.loaded?": "+e.filecontent.name:""))]),e._v(" "),a("div",{staticClass:"project-path-info"},[e._v("可以控制单个规则是否启用，当规则所在规则集没有启用时，规则不管是否启用，都不会生效。")]),e._v(" "),a("el-row",{staticStyle:{"margin-bottom":"10px","text-align":"right"},attrs:{gutter:20}},[a("el-col",{attrs:{span:6,offset:18}},[a("el-button",{attrs:{size:"small"},on:{click:e.addRule}},[e._v("新增规则")])],1)],1),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{border:"","row-key":"key",stripe:!0,align:"center",data:e.filecontent.content}},[a("el-table-column",{attrs:{label:"启用",align:"center",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-checkbox",{on:{change:e.saveFileRightNow},model:{value:t.row.checked,callback:function(a){e.$set(t.row,"checked",a)},expression:"scope.row.checked"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"规则名",width:"150",prop:"name",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"匹配方法",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s(t.row.method?t.row.method:"全部")+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"匹配路径",prop:"match",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:200,align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"action-panel"},[a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini"},on:{click:function(a){return e.onDeleteRow(t.row,t.$index)}}}),e._v(" "),a("el-button",{attrs:{icon:"el-icon-document",size:"mini"},on:{click:function(a){return e.onDuplicateRow(t.row,t.$index)}}}),e._v(" "),a("el-button",{attrs:{icon:"el-icon-edit",size:"mini"},on:{click:function(a){return e.onEditRule(t.row,t.$index)}}})],1)]}}])})],1),e._v(" "),a("rule-edit-form",{ref:"ruleEditForm",attrs:{"data-list":e.$dc.dataList,"user-id":e.$dc.userId},on:{"new-data-file":e.requestNewDataFile,"edit-data-file":e.requestEditDataFile,save:e.saveRule}}),e._v(" "),a("el-dialog",{attrs:{title:"匹配规则测试(只测试正则匹配，不包含请求方法)",size:"large"},model:{value:e.testMatchRuleFormVisible,callback:function(t){e.testMatchRuleFormVisible=t},expression:"testMatchRuleFormVisible"}},[a("el-form",{attrs:{model:e.testMatchRuleForm,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"请求url"}},[a("el-input",{model:{value:e.testMatchRuleForm.url,callback:function(t){e.$set(e.testMatchRuleForm,"url",t)},expression:"testMatchRuleForm.url"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"匹配条件"}},[a("el-input",{model:{value:e.testMatchRuleForm.match,callback:function(t){e.$set(e.testMatchRuleForm,"match",t)},expression:"testMatchRuleForm.match"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"转发路径"}},[a("el-input",{model:{value:e.testMatchRuleForm.targetTpl,callback:function(t){e.$set(e.testMatchRuleForm,"targetTpl",t)},expression:"testMatchRuleForm.targetTpl"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"匹配结果"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.testMatchRuleForm.matchRlt,callback:function(t){e.$set(e.testMatchRuleForm,"matchRlt",t)},expression:"testMatchRuleForm.matchRlt"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"最终目标路径"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.testMatchRuleForm.targetRlt,callback:function(t){e.$set(e.testMatchRuleForm,"targetRlt",t)},expression:"testMatchRuleForm.targetRlt"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"其他信息"}},[a("el-input",{attrs:{type:"textarea",disabled:!0},model:{value:e.testMatchRuleForm.msg,callback:function(t){e.$set(e.testMatchRuleForm,"msg",t)},expression:"testMatchRuleForm.msg"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.testMatchRuleFormVisible=!1}}},[e._v("关 闭")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.testMatchRule}},[e._v("测 试")])],1)],1)],1)};Pe._withStripped=!0;var De=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:e.isEditRule?"编辑规则":"新建规则",visible:e.visible,width:"80%"},on:{"update:visible":function(t){e.visible=t}}},[a("div",{staticClass:"rule-edit-form"},[a("div",{staticClass:"el-form demo-form-inline el-form--inline conditon"},[a("div",{staticClass:"el-form-item",staticStyle:{"margin-bottom":"8px"}},[a("label",{staticClass:"el-form-item__label"},[e._v("条件")]),e._v(" "),a("div",{staticClass:"el-form-item__content"},[a("el-select",{staticStyle:{width:"100px"},attrs:{size:"small",placeholder:"请选择"},model:{value:e.rule.method,callback:function(t){e.$set(e.rule,"method",t)},expression:"rule.method"}},e._l(e.methodList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)]),e._v(" "),a("div",{staticClass:"el-form-item",staticStyle:{"margin-bottom":"8px",width:"calc(100% - 170px)","padding-left":"20px","margin-right":"0px"}},[a("div",{staticClass:"el-form-item__content",staticStyle:{width:"100%"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{size:"small",placeholder:"填写要拦截的url中部分连续的字符串，或者匹配要拦截url的正则表达式"},model:{value:e.rule.match,callback:function(t){e.$set(e.rule,"match",t)},expression:"rule.match"}})],1)])]),e._v(" "),a("div",{staticStyle:{padding:"10px 0"}},[a("span",{staticStyle:{width:"85%",display:"inline-block"}},[a("el-input",{attrs:{size:"small",placeholder:"规则说明，写一段文字，方便记忆这个规则的作用"},model:{value:e.rule.name,callback:function(t){e.$set(e.rule,"name",t)},expression:"rule.name"}})],1),e._v(" "),a("span",{staticStyle:{width:"10%",display:"inline-block"}},[a("el-button",{attrs:{type:"text"},on:{click:e.addAction}},[e._v("新增动作")])],1)]),e._v(" "),a("div",e._l(e.rule.actionList,(function(t,n){return a("div",{key:n,staticClass:"dashed-border"},[a("span",{staticStyle:{width:"85%",display:"inline-block"}},[a("action-detail",{attrs:{action:t,"rule-types":e.ruleTypes,"data-list":e.dataList,"user-id":e.userId},on:{"new-data-file":function(t){return e.$emit("new-data-file",n)},"edit-data-file":function(t){return e.$emit("edit-data-file",t)}}})],1),e._v(" "),a("span",{staticStyle:{width:"10%",display:"inline-block","vertical-align":"bottom","line-height":"107px",height:"107px"}},[a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.deleteAction(n)}}},[e._v("删除动作")])],1)])})),0),e._v(" "),a("div",{staticStyle:{"text-align":"right"}},[a("el-button",{on:{click:e.cancelEdit}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.saveRule}},[e._v(e._s(e.isEditRule?"保存规则":"创建规则"))])],1)])])};De._withStripped=!0;var Ie=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{"text-align":"left"}},[a("div",{staticClass:"inline-block left-panel"},[a("el-select",{staticStyle:{"margin-top":"25px","margin-right":"10px","font-size":"12px"},attrs:{placeholder:"请选择",size:"small"},model:{value:e.action.type,callback:function(t){e.$set(e.action,"type",t)},expression:"action.type"}},e._l(e.ruleTypes,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),"redirect"==e.action.type?a("div",{staticClass:"inline-block right-panel"},[a("div",{staticClass:"action-data"},[a("el-input",{attrs:{size:"small",placeholder:e.redirectPlaceholder},model:{value:e.action.data.target,callback:function(t){e.$set(e.action.data,"target",t)},expression:"action.data.target"}})],1)]):e._e(),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:"mockData"==e.action.type,expression:"action.type == 'mockData'"}],staticClass:"inline-block right-panel"},[a("div",{staticClass:"action-data"},[a("span",[a("el-select",{staticStyle:{width:"300px"},attrs:{size:"small",filterable:"",placeholder:"请选择要返回的数据"},model:{value:e.action.data.dataId,callback:function(t){e.$set(e.action.data,"dataId",t)},expression:"action.data.dataId"}},e._l(e.dataList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),e._v(" "),e.datafileEntry?a("span",{staticStyle:{"margin-left":"10px"}},[a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.$emit("edit-data-file",e.datafileEntry)}}},[e._v("\n              编辑数据\n            ")])],1):e._e(),e._v(" "),a("span",{staticStyle:{"margin-left":"10px"}},[a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.$emit("new-data-file")}}},[e._v("增加自定义数据")])],1)])]),e._v(" "),"addRequestCookie"==e.action.type?a("div",{staticClass:"inline-block right-panel"},[a("div",{staticClass:"action-data"},[a("el-input",{staticStyle:{display:"inline-block",width:"120px"},attrs:{size:"small",placeholder:"cookie key"},model:{value:e.action.data.cookieKey,callback:function(t){e.$set(e.action.data,"cookieKey",t)},expression:"action.data.cookieKey"}}),e._v(" "),a("el-input",{staticStyle:{display:"inline-block",width:"300px"},attrs:{size:"small",placeholder:"cookie value"},model:{value:e.action.data.cookieValue,callback:function(t){e.$set(e.action.data,"cookieValue",t)},expression:"action.data.cookieValue"}})],1)]):e._e(),e._v(" "),"modifyResponse"==e.action.type?a("div",{staticClass:"inline-block right-panel"},[a("div",{staticClass:"action-data"},[a("el-select",{staticStyle:{width:"260px"},attrs:{size:"small",placeholder:"请选择修改返回body操作"},model:{value:e.action.data.modifyResponseType,callback:function(t){e.$set(e.action.data,"modifyResponseType",t)},expression:"action.data.modifyResponseType"}},e._l(e.modifyResponseType,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),e._v(" "),"returnDataInJsonpStyle"==e.action.data.modifyResponseType?a("span",[a("el-input",{staticStyle:{width:"200px"},attrs:{size:"small",placeholder:"jsonp callback参数名"},model:{value:e.action.data.callbackName,callback:function(t){e.$set(e.action.data,"callbackName",t)},expression:"action.data.callbackName"}})],1):e._e()],1)]):e._e(),e._v(" "),"addRequestHeader"==e.action.type?a("div",{staticClass:"inline-block right-panel"},[a("div",{staticClass:"action-data"},[a("el-input",{staticStyle:{display:"inline-block",width:"120px"},attrs:{size:"small",placeholder:"header key"},model:{value:e.action.data.reqHeaderKey,callback:function(t){e.$set(e.action.data,"reqHeaderKey",t)},expression:"action.data.reqHeaderKey"}}),e._v(" "),a("el-input",{staticStyle:{display:"inline-block",width:"300px"},attrs:{size:"small",placeholder:"header value"},model:{value:e.action.data.reqHeaderValue,callback:function(t){e.$set(e.action.data,"reqHeaderValue",t)},expression:"action.data.reqHeaderValue"}})],1)]):e._e(),e._v(" "),"addQuery"==e.action.type?a("div",{staticClass:"inline-block right-panel"},[a("div",{staticClass:"action-data"},[a("el-input",{staticStyle:{display:"inline-block",width:"120px"},attrs:{size:"small",placeholder:"query key"},model:{value:e.action.data.queryKey,callback:function(t){e.$set(e.action.data,"queryKey",t)},expression:"action.data.queryKey"}}),e._v(" "),a("el-input",{staticStyle:{display:"inline-block",width:"300px"},attrs:{size:"small",placeholder:"query value"},model:{value:e.action.data.queryValue,callback:function(t){e.$set(e.action.data,"queryValue",t)},expression:"action.data.queryValue"}})],1)]):e._e(),e._v(" "),"addResponseHeader"==e.action.type?a("div",{staticClass:"inline-block right-panel"},[a("div",{staticClass:"action-data"},[a("el-input",{staticStyle:{display:"inline-block",width:"120px"},attrs:{size:"small",placeholder:"header key"},model:{value:e.action.data.resHeaderKey,callback:function(t){e.$set(e.action.data,"resHeaderKey",t)},expression:"action.data.resHeaderKey"}}),e._v(" "),a("el-input",{staticStyle:{display:"inline-block",width:"300px"},attrs:{size:"small",placeholder:"header value"},model:{value:e.action.data.resHeaderValue,callback:function(t){e.$set(e.action.data,"resHeaderValue",t)},expression:"action.data.resHeaderValue"}})],1)]):e._e(),e._v(" "),"scriptModifyRequest"==e.action.type?a("div",{staticClass:"inline-block right-panel"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.action.data.modifyRequestScript,expression:"action.data.modifyRequestScript"}],staticStyle:{width:"500px",height:"90px"},domProps:{value:e.action.data.modifyRequestScript},on:{input:function(t){t.target.composing||e.$set(e.action.data,"modifyRequestScript",t.target.value)}}})]):e._e(),e._v(" "),"scriptModifyResponse"==e.action.type?a("div",{staticClass:"inline-block right-panel"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.action.data.modifyResponseScript,expression:"action.data.modifyResponseScript"}],staticStyle:{width:"500px",height:"90px"},domProps:{value:e.action.data.modifyResponseScript},on:{input:function(t){t.target.composing||e.$set(e.action.data,"modifyResponseScript",t.target.value)}}})]):e._e()])};Ie._withStripped=!0;var Ee={name:"action-detail",props:["action","ruleTypes","dataList","userId"],data:function(){return{modifyResponseType:[{value:"addTimestampToJsCss",label:"将html中的js、css请求加上时间戳"},{value:"returnDataInJsonpStyle",label:"以JSONP的方式返回数据"},{value:"allowCros",label:"增加跨域头部"},{value:"return404",label:"返回404"}]}},computed:{datafileEntry:function(){var e=this;if("mockData"==this.action.type){var t=Fe()(this.dataList,(function(t){return t.id==e.action.data.dataId}));return t||(this.action.data.dataId=""),t}},redirectPlaceholder:function(){return"root"==this.userId?"填写转发路径(远程地址、或者本地地址。远程地址需要以http/https开头)":"填写转发路径(必须以http/https开头)"}}},He=(a(330),Object(c.a)(Ee,Ie,[],!1,null,null,null));He.options.__file="src/manager/components/rule-edit-form/ActionDetail.vue";var qe=He.exports;a(331);var Oe,Te,Le,je={name:"",key:"",method:"",match:"",checked:!1,actionList:[]},Me={type:"redirect",data:{target:"",dataId:"",modifyResponseType:"",callbackName:"",cookieKey:"",cookieValue:"",reqHeaderKey:"",reqHeaderValue:"",resHeaderKey:"",resHeaderValue:"",queryKey:"",queryValue:"",modifyRequestScript:"",modifyResponseScript:""}},Ne={name:"RuleEditForm",props:["dataList","userId"],components:(Oe={},Te=qe.name,Le=qe,Te in Oe?Object.defineProperty(Oe,Te,{value:Le,enumerable:!0,configurable:!0,writable:!0}):Oe[Te]=Le,Oe),data:function(){return{visible:!1,isFilterRule:!1,isEditRule:!1,rule:JSON.parse(JSON.stringify(je)),ruleIndex:-1,methodList:[{value:"",label:"所有"},{value:"get",label:"GET"},{value:"post",label:"POST"},{value:"put",label:"PUT"},{value:"patch",label:"PATCH"},{value:"delete",label:"DELETE"},{value:"option",label:"OPTION"}]}},computed:{ruleTypes:function(){return this.isFilterRule?[{value:"addRequestHeader",label:"增加请求头"},{value:"addQuery",label:"增加Query"},{value:"addResponseHeader",label:"增加响应头"},{value:"addRequestCookie",label:"设置请求cookie"},{value:"scriptModifyRequest",label:"js修改请求内容"},{value:"scriptModifyResponse",label:"js修改响应内容"}]:[{value:"redirect",label:"转发请求"},{value:"mockData",label:"返回自定义数据"},{value:"addRequestHeader",label:"增加请求头"},{value:"addQuery",label:"增加Query"},{value:"addResponseHeader",label:"增加响应头"},{value:"modifyResponse",label:"修改响应内容"},{value:"addRequestCookie",label:"设置请求cookie"},{value:"scriptModifyRequest",label:"js修改请求内容"},{value:"scriptModifyResponse",label:"js修改响应内容"}]}},methods:{cancelEdit:function(){this.visible=!1},saveRule:function(){this.$emit("save",{isEditRule:this.isEditRule,ruleIndex:this.ruleIndex,rule:JSON.parse(JSON.stringify(this.rule))}),this.visible=!1},editRule:function(e){var t=e.rule,a=e.isFilterRule,n=e.ruleIndex;this.isEditRule=!0,this.ruleIndex=n,this.isFilterRule=a,this.rule=JSON.parse(JSON.stringify(t)),this.visible=!0},createRule:function(e){var t,a=e.initialRule,n=e.isFilterRule,i=void 0!==n&&n;if(this.ruleIndex=-1,this.isEditRule=!1,this.isFilterRule=i,a)t=JSON.parse(JSON.stringify(a));else{t=JSON.parse(JSON.stringify(je));var o=JSON.parse(JSON.stringify(Me));o.type=this.isFilterRule?"addRequestHeader":"redirect",t.actionList.push(o)}t.key=I()(),this.rule=t,this.visible=!0},addAction:function(){var e=JSON.parse(JSON.stringify(Me));e.type=this.isFilterRule?"addRequestHeader":"redirect",this.rule.actionList.push(e)},deleteAction:function(e){this.rule.actionList.splice(e,1)},setActionDataFileId:function(e,t){this.rule.actionList[e].data.dataId=t}}},Ue=Object(c.a)(Ne,De,[],!1,null,null,null);Ue.options.__file="src/manager/components/rule-edit-form/Index.vue";var ze=Ue.exports;var Ve={name:"edit-rule",components:function(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}({},ze.name,ze),data:function(){return{loaded:!1,name:"",filecontent:{meta:{}},testMatchRuleFormVisible:!1,testMatchRuleForm:{url:"",match:"",targetTpl:"",matchRlt:"",targetRlt:"",msg:""}}},methods:{requestNewDataFile:function(e){var t=this.$refs.ruleEditForm;this.$dc.requestAddDataFile((function(a){t.setActionDataFileId(e,a)}))},requestEditDataFile:function(e){this.$dc.requestEditDataFile(e)},getFile:function(){var e=this;this.loaded=!1,this.name=this.$route.query.name,$.getFileContent(this.name).then((function(t){var a=t.data;0==a.code?(e.loaded=!0,e.$dc.dataList.length>0?e.filecontent=a.data:setTimeout((function(){e.filecontent=a.data}),1e3)):e.$message.error("出错了，".concat(a.msg))})).catch((function(t){e.filecontent={meta:{},content:[]}}))},addRule:function(){this.$refs.ruleEditForm.createRule({})},onDuplicateRow:function(e,t){this.$refs.ruleEditForm.createRule({initialRule:e})},onEditRule:function(e,t){this.$refs.ruleEditForm.editRule({rule:e,ruleIndex:t})},onDeleteRow:function(e,t){var a=this;this.$confirm("此操作不可恢复, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){a.filecontent.content.splice(t,1),a.saveFileRightNow()}))},saveRule:function(e){var t=e.isEditRule,a=e.rule,n=e.ruleIndex;if(t){var i=this.filecontent.content[n];Object.assign(i,a)}else this.filecontent.content.push(a);this.saveFileRightNow()},saveFileRightNow:function(){this.saveFile(),$.debouncedSaveFile.flush()},saveFile:function(e){var t=this;$.debouncedSaveFile(this.name,this.filecontent,(function(a){var n=a.data;0==n.code?e||t.$message({showClose:!0,type:"success",message:"保存成功!"}):t.$message.error("出错了，".concat(n.msg))}))},testMatchRuleRequest:function(e){this.testMatchRuleForm.match=e.match,this.testMatchRuleForm.targetTpl=e.actionList[0]&&e.actionList[0].data.target||"",this.testMatchRuleForm.url="",this.testMatchRuleForm.matchRlt="",this.testMatchRuleForm.targetRlt="",this.testMatchRuleForm.msg="",this.testMatchRuleFormVisible=!0},testMatchRule:function(){var e=this;$.testRule(this.testMatchRuleForm).then((function(t){var a=t.data;0==a.code&&(e.testMatchRuleForm.matchRlt=a.data.matchRlt,e.testMatchRuleForm.targetRlt=a.data.targetRlt,e.testMatchRuleForm.msg=a.data.msg)}))}},mounted:function(){this.getFile()},watch:{$route:function(e,t){this.getFile()}}},Ae=(a(332),Object(c.a)(Ve,Pe,[],!1,null,null,null));Ae.options.__file="src/manager/components/rule/EditRule.vue";var Be=Ae.exports,Je=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"main-content__title"},[e._v("创建规则集")]),e._v(" "),a("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",staticStyle:{margin:"20px",width:"60%","min-width":"600px"},attrs:{model:e.createFileForm,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"规则集名字",prop:"name"}},[a("el-input",{model:{value:e.createFileForm.name,callback:function(t){e.$set(e.createFileForm,"name",t)},expression:"createFileForm.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"规则集描述",prop:"description"}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.createFileForm.description,callback:function(t){e.$set(e.createFileForm,"description",t)},expression:"createFileForm.description"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("立即创建")]),e._v(" "),a("el-button",{on:{click:function(t){return e.back()}}},[e._v("返回")])],1)],1)],1)};Je._withStripped=!0;var Ke={name:"app",data:function(){return{createFileForm:{name:"",checked:!0,description:""},rules:{name:[{required:!0,message:"请输入文件名称名称",trigger:"blur"},{min:2,max:50,message:"长度在 2 到 20 个字符",trigger:"blur"}],description:[{required:!0,message:"请填文件描述",trigger:"blur"}]}}},methods:{submitForm:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return console.log("error submit!!"),!1;$.createFile(t.createFileForm.name,t.createFileForm.description).then((function(e){var a=e.data;0==a.code?(t.$message({showClose:!0,message:"恭喜你，创建成功",type:"success"}),t.$router.push("editrule?name=".concat(t.createFileForm.name))):t.$message.error("出错了，".concat(a.msg))}))}))},back:function(){this.$router.push("rulefilelist")}}},Qe=Object(c.a)(Ke,Je,[],!1,null,null,null);Qe.options.__file="src/manager/components/rule/CreateFile.vue";var Ge=Qe.exports,We=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"main-content__title"},[e._v("过滤器")]),e._v(" "),a("div",{staticClass:"project-path-info"},[e._v("一个http请求会可以执行多个匹配的过滤器；过滤器可以用于向http请求里植入登录态。可以控制单个过滤器是否启用")]),e._v(" "),a("el-row",{staticStyle:{"margin-bottom":"10px","text-align":"right"},attrs:{gutter:20}},[a("el-col",{attrs:{span:6,offset:18}},[a("el-button",{attrs:{size:"small"},on:{click:e.addRule}},[e._v("新增过滤器")])],1)],1),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{border:"","row-key":"key",stripe:!0,align:"center",data:e.$dc.filters}},[a("el-table-column",{attrs:{prop:"checked",label:"启用",align:"center",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-checkbox",{attrs:{disabled:!e.$dc.filterState},on:{change:e.saveFileRightNow},model:{value:t.row.checked,callback:function(a){e.$set(t.row,"checked",a)},expression:"scope.row.checked"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"规则名",width:"150",prop:"name",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"匹配方法",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s(t.row.method?t.row.method:"全部")+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"匹配路径",prop:"match",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"200",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"action-panel"},[a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini"},on:{click:function(a){return e.onDeleteRow(t.row,t.$index)}}}),e._v(" "),a("el-button",{attrs:{icon:"el-icon-document",size:"mini"},on:{click:function(a){return e.onDuplicateRow(t.row,t.$index)}}}),e._v(" "),a("el-button",{attrs:{icon:"el-icon-edit",size:"mini"},on:{click:function(a){return e.onEditRule(t.row,t.$index)}}})],1)]}}])})],1),e._v(" "),a("rule-edit-form",{ref:"ruleEditForm",attrs:{"data-list":e.$dc.dataList,"user-id":e.$dc.userId},on:{"new-data-file":e.requestNewDataFile,"edit-data-file":e.requestEditDataFile,save:e.saveRule}})],1)};We._withStripped=!0;var Xe={saveFilters:function(e){return _.a.post("/filter/savefilters",e)}};a(333);function Ye(e,t,a,n,i,o,r){try{var l=e[o](r),s=l.value}catch(e){return void a(e)}l.done?t(s):Promise.resolve(s).then(n,i)}var Ze,et={name:"filters",components:function(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}({},ze.name,ze),methods:{requestNewDataFile:function(e){var t=this.$refs.ruleEditForm;this.$dc.requestAddDataFile((function(a){t.setActionDataFileId(e,a)}))},requestEditDataFile:function(e){this.$dc.requestEditDataFile(e)},addRule:function(e,t){this.$refs.ruleEditForm.createRule({isFilterRule:!0})},onDuplicateRow:function(e,t){this.$refs.ruleEditForm.createRule({initialRule:e,isFilterRule:!0})},onEditRule:function(e,t){this.$refs.ruleEditForm.editRule({rule:e,ruleIndex:t,isFilterRule:!0})},onDeleteRow:function(e,t,a){var n=this;this.$confirm("此操作不可恢复, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){n.$dc.filters.splice(t,1),n.saveFileRightNow()}))},saveRule:function(e){var t=e.isEditRule,a=e.rule,n=e.ruleIndex;if(t){var i=this.$dc.filters[n];Object.assign(i,a)}else this.$dc.filters.push(a);this.saveFileRightNow()},saveFileRightNow:(Ze=function(e){return function(){var t=this,a=arguments;return new Promise((function(n,i){var o=e.apply(t,a);function r(e){Ye(o,n,i,r,l,"next",e)}function l(e){Ye(o,n,i,r,l,"throw",e)}r(void 0)}))}}(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Xe.saveFilters(this.$dc.filters);case 2:0==e.sent.code&&this.$message({showClose:!0,type:"success",message:"保存成功!"});case 4:case"end":return e.stop()}}),e,this)}))),function(){return Ze.apply(this,arguments)})}},tt=Object(c.a)(et,We,[],!1,null,null,null);tt.options.__file="src/manager/components/filter/Filter.vue";var at=tt.exports,nt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"main-content__title"},[e._v("自定义数据文件列表")]),e._v(" "),a("div",{staticClass:"project-path-info"},[e._v("在http转发规则里面，可以配置将这里的mock数据返回给浏览器")]),e._v(" "),a("el-row",{staticStyle:{"margin-bottom":"10px"},attrs:{gutter:20}},[a("el-col",{staticClass:"addhost-btn-wrap",attrs:{span:6,offset:18}},[a("el-button",{attrs:{size:"small"},on:{click:function(t){return e.$dc.requestAddDataFile()}}},[e._v("新增数据文件")])],1)],1),e._v(" "),a("el-table",{attrs:{border:"",align:"center",data:e.$dc.dataList}},[a("el-table-column",{attrs:{prop:"name",label:"名字",align:"center",width:"300",sortable:!0}}),e._v(" "),a("el-table-column",{attrs:{prop:"contenttype",label:"类型",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:136,align:"center",context:e._self},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"info",icon:"el-icon-edit",size:"mini"},on:{click:function(a){return e.$dc.requestEditDataFile(t.row)}}}),e._v(" "),a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini"},on:{click:function(a){return e.$dc.deleteDataFile(t.row,t.$index)}}})]}}])})],1)],1)};nt._withStripped=!0;var it={name:"mockdatalist"},ot=(a(334),Object(c.a)(it,nt,[],!1,null,null,null));ot.options.__file="src/manager/components/data/DataList.vue";var rt=ot.exports,lt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"main-content__title"},[e._v("绑定的设备列表")]),e._v(" "),e._m(0),e._v(" "),a("div",{staticClass:"bind-qrcode-panel"},[a("div",{staticClass:"title"},[e._v("扫码绑定设备")]),e._v(" "),a("div",{staticClass:"qrcode"},[a("img",{staticClass:"bind-qrcode",attrs:{src:e.imgUrl}})]),e._v(" "),a("div",{staticClass:"bottom"},[a("el-button",{attrs:{type:"text"},on:{click:e.copyBindUrl}},[e._v("点击复制绑定链接")])],1)]),e._v(" "),a("el-table",{staticStyle:{width:"800px"},attrs:{border:"",align:"center",data:this.$dc.bindedDeviceList}},[a("el-table-column",{attrs:{prop:"id",label:"ID",align:"center",width:"150",sortable:!0}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"Name",align:"center",sortable:!0}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:136,align:"center",context:e._self},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini"},on:{click:function(a){return e.unbind(t.row,t.$index)}}})]}}])})],1)],1)};lt._withStripped=!0;var st=a(28),ct=a.n(st);a(336);function ut(e,t,a,n,i,o,r){try{var l=e[o](r),s=l.value}catch(e){return void a(e)}l.done?t(s):Promise.resolve(s).then(n,i)}var dt,pt={name:"DeviceList",methods:{copyBindUrl:function(){ye()(this.bindUrl),this.$message("已将设备绑定链接复制到剪切板，在设备中打开此url即可绑定设备")},unbind:(dt=function(e){return function(){var t=this,a=arguments;return new Promise((function(n,i){var o=e.apply(t,a);function r(e){ut(o,n,i,r,l,"next",e)}function l(e){ut(o,n,i,r,l,"throw",e)}r(void 0)}))}}(regeneratorRuntime.mark((function e(t,a){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a.unBind(t.id);case 2:this.$message("解绑成功");case 3:case"end":return e.stop()}}),e,this)}))),function(e,t){return dt.apply(this,arguments)})},computed:{bindUrl:function(){return"http://".concat(this.$dc.appInfo.pcIp,":").concat(this.$dc.appInfo.webUiPort,"/profile/device/bind?userId=").concat(this.$dc.userId)},imgUrl:function(){return ct.a.toDataURL(this.bindUrl,4)}}},mt=Object(c.a)(pt,lt,[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"project-path-info"},[this._v("\n        列表中的设备通过http trick发起请求时，请求会被当前用户的过滤器、规则处理。"),t("br"),this._v("\n        如果设备没有绑定任何用户则会使用root用户的过滤器、规则。"),t("br"),this._v("\n        扫描右边的二维码可绑定设备。\n    ")])}],!1,null,null,null);mt.options.__file="src/manager/components/device/DeviceList.vue";var ft=mt.exports,vt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"install-body"},[a("h1",[e._v("Http Trick")]),e._v(" "),a("h2",{attrs:{id:"toc_0"}},[e._v("一、说明")]),e._v(" "),a("p",[e._v("http trick是http协议代理工具，需要设置浏览器代理或者系统代理才能使用本工具。")]),e._v(" "),a("p",[e._v("另http trick外依赖 openssl 生成证书，请先安装 openssl (版本建议在 0.9.8 以上)。")]),e._v(" "),a("p",[e._v("PAC: "+e._s(e.pacUrl))]),e._v(" "),a("h2",{attrs:{id:"toc_1"}},[e._v("二、chrome 代理插件安装(用于设置浏览器代理)")]),e._v(" "),e._m(0),e._v(" "),a("h4",{attrs:{id:"toc_2"}},[e._v("插件使用说明")]),e._v(" "),e._m(1),e._v(" "),a("h2",{attrs:{id:"toc_3"}},[e._v("三、证书安装")]),e._v(" "),a("h4",{attrs:{id:"toc_4"}},[e._v("1. 为什么需要安装证书")]),e._v(" "),e._m(2),e._v(" "),a("h4",{attrs:{id:"toc_5"}},[e._v("2. 证书下载")]),e._v(" "),a("ol",[a("li",[e._v("mac 系统请"),a("a",{attrs:{href:e.url}},[e._v("点击下载到本地安装")])]),e._v(" "),a("li",[e._v("手机请扫码安装证书"),a("img",{staticClass:"install-body__qrcode",attrs:{src:e.imgUrl}})]),e._v(" "),e._m(3)])])};vt._withStripped=!0;var ht={name:"help-info",data:function(){return{}},computed:{url:function(){return"http://"+this.$dc.appInfo.pcIp+":"+this.$dc.appInfo.webUiPort+"/utils/rootCA.crt"},imgUrl:function(){var e="http://"+this.$dc.appInfo.pcIp+":"+this.$dc.appInfo.webUiPort+"/utils/rootCA.crt";return ct.a.toDataURL(e,4)},pacUrl:function(){return"http://".concat(this.$dc.appInfo.pcIp,":").concat(this.$dc.appInfo.webUiPort,"/profile/").concat(this.$dc.userId,"/proxy.pac")}}},gt=(a(337),Object(c.a)(ht,vt,[function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("推荐安装 SwitchyOmega "),t("a",{attrs:{href:"https://chrome.google.com/webstore/detail/proxy-switchyomega/padekgcemlokbadohgkifijomclgjgif?hl=en-US",target:"_blank"}},[this._v("点击安装代理插件")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ol",[a("li",[e._v("安装完插件后请设置插件代理地址为"),a("code",[e._v("127.0.0.1")]),e._v("，代理协议: http，端口为"),a("code",[e._v("http trick")]),e._v("代理端口(默认8001)。")]),e._v(" "),a("li",[e._v("如不清楚如何配置 SwitchyOmega，请参考 "),a("a",{attrs:{href:"/help/chrome/",target:"_blank"}},[e._v("chrome 代理设置指南")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("由于"),t("code",[this._v("http trick")]),this._v("会代理 https 的请求，所以需要本地安装"),t("code",[this._v("http trick")]),this._v("的https 证书。")])},function(){var e=this.$createElement,t=this._self._c||e;return t("li",[this._v("证书信任请参考"),t("a",{attrs:{href:"/help/cert/",target:"_blank"}},[this._v("如何信任证书")])])}],!1,null,null,null));gt.options.__file="src/manager/components/help/Install.vue";var bt=gt.exports,_t=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"socks-configure"},[a("div",{staticClass:"main-content__title"},[e._v("代理配置")]),e._v(" "),a("el-form",{attrs:{"label-width":"200px"}},[a("el-form-item",{attrs:{label:"使用外部代理"}},[a("el-checkbox",{model:{value:e.$dc.profile.externalProxy,callback:function(t){e.$set(e.$dc.profile,"externalProxy",t)},expression:"$dc.profile.externalProxy"}},[e._v("使用")])],1),e._v(" "),e.$dc.profile.externalProxy?a("el-form-item",{attrs:{label:"外部代理类型"}},[a("el-radio-group",{model:{value:e.socks5Proxy,callback:function(t){e.socks5Proxy=t},expression:"socks5Proxy"}},[a("el-radio",{attrs:{label:!0}},[e._v("Socks5代理")]),e._v(" "),a("el-radio",{attrs:{label:!1}},[e._v("Http代理")])],1)],1):e._e(),e._v(" "),e.$dc.profile.externalProxy&&!e.socks5Proxy?a("el-form-item",{attrs:{label:"External Http代理"}},[a("div",{staticClass:"http-proxy"},[a("el-input",{staticClass:"ip",attrs:{placeholder:"Http Proxy Ip"},model:{value:e.$dc.profile.httpProxyIp,callback:function(t){e.$set(e.$dc.profile,"httpProxyIp",t)},expression:"$dc.profile.httpProxyIp"}}),e._v("\n                :\n                "),a("el-input",{staticClass:"port",attrs:{placeholder:"http Proxy port"},model:{value:e.$dc.profile.httpProxyPort,callback:function(t){e.$set(e.$dc.profile,"httpProxyPort",t)},expression:"$dc.profile.httpProxyPort"}})],1)]):e._e(),e._v(" "),e.$dc.profile.externalProxy&&e.socks5Proxy?a("el-form-item",{attrs:{label:"External Socks代理"}},[a("div",{staticClass:"http-proxy"},[a("el-input",{staticClass:"ip",attrs:{placeholder:"Socks5 Proxy Ip"},model:{value:e.$dc.profile.socks5ProxyIp,callback:function(t){e.$set(e.$dc.profile,"socks5ProxyIp",t)},expression:"$dc.profile.socks5ProxyIp"}}),e._v("\n                :\n                "),a("el-input",{staticClass:"port",attrs:{placeholder:"socks5 Proxy port"},model:{value:e.$dc.profile.socks5ProxyPort,callback:function(t){e.$set(e.$dc.profile,"socks5ProxyPort",t)},expression:"$dc.profile.socks5ProxyPort"}})],1)]):e._e(),e._v(" "),a("el-form-item",{attrs:{label:"需要Http解析代理的域名"}},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.$dc.profile.goThroughProxyConfig,expression:"$dc.profile.goThroughProxyConfig"}],staticClass:"socks-editor",attrs:{placeholder:e.socksProxyExample},domProps:{value:e.$dc.profile.goThroughProxyConfig},on:{input:function(t){t.target.composing||e.$set(e.$dc.profile,"goThroughProxyConfig",t.target.value)}}})]),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.saveFile}},[e._v("保存")])],1)],1)],1)};function yt(e,t,a,n,i,o,r){try{var l=e[o](r),s=l.value}catch(e){return void a(e)}l.done?t(s):Promise.resolve(s).then(n,i)}_t._withStripped=!0;var xt={name:"configure",computed:{socksProxyExample:function(){return"#示例\nall               # 有all 配置项，所有域名君走http解析代理\n*.domain.com      # 所有domain域名都会走Http解析代理\nwww.domain.com    # www.domain.com走Http解析代理"},socks5Proxy:{get:function(){return this.$dc.profile.externalSocks5Proxy},set:function(e){e?(this.$dc.profile.externalSocks5Proxy=!0,this.$dc.profile.externalHttpProxy=!1):(this.$dc.profile.externalSocks5Proxy=!1,this.$dc.profile.externalHttpProxy=!0)}}},methods:{saveFile:function(){var e=function(e){return function(){var t=this,a=arguments;return new Promise((function(n,i){var o=e.apply(t,a);function r(e){yt(o,n,i,r,l,"next",e)}function l(e){yt(o,n,i,r,l,"throw",e)}r(void 0)}))}}(regeneratorRuntime.mark((function e(){var t,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a.saveFile(this.$dc.profile);case 2:t=e.sent,0==(a=t.data).code?this.$message({showClose:!0,type:"success",message:"保存成功!"}):this.$message.error("出错了，".concat(a.msg));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}},kt=(a(338),Object(c.a)(xt,_t,[],!1,null,null,null));kt.options.__file="src/manager/components/proxy/Configure.vue";var Ft=kt.exports;o.default.use(B.a);var wt=new B.a({routes:[{path:"/configure",component:ee},{path:"/redirect-path-variable",component:oe},{path:"/hostfilelist",component:ce},{path:"/edithost",component:me},{path:"/createhostfile",component:ge},{path:"/rulefilelist",component:Ce},{path:"/editrule",component:Be},{path:"/createrulefile",component:Ge},{path:"/filter",component:at},{path:"/datalist",component:rt},{path:"/device",component:ft},{path:"/helpinstall",component:bt,alias:"/"},{path:"/proxyconfig",component:Ft}]}),$t=a(66),Rt=a.n($t);a(339),a(340);o.default.use(i.a),o.default.use(Rt.a),new o.default({el:"#app",router:wt,render:function(e){return e(A)}}),document.addEventListener("keydown",(function(e){if((event.ctrlKey||event.metaKey)&&83==event.which)return event.preventDefault(),!1}),!0)},54:function(e,t,a){},55:function(e,t,a){},56:function(e,t,a){},57:function(e,t,a){},58:function(e,t,a){},59:function(e,t,a){},60:function(e,t,a){},61:function(e,t,a){},62:function(e,t,a){}});